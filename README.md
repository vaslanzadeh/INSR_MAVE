# INSR_MAVE Analysis Pipeline

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.xxxxxxx.svg)](https://doi.org/10.5281/zenodo.xxxxxxx)

---

## Data and Analysis Pipeline  

The **analysis scripts** are provided in this repository.  
All **required datasets** to run the scripts (including input files for each step) are hosted separately on Zenodo due to file size limits:  
➡ **[Download the dataset from Zenodo (DOI: 10.5281/zenodo.xxxxxxx)](https://doi.org/10.5281/zenodo.xxxxxxx)**  

---

### Step-by-Step Analysis  

1. **Preprocessing PacBio data**  
   - Download the Zenodo dataset and place it in the working directory.  
   - Run `pbData_analysis.ipynb`.  
   - PacBio HiFi FastQ reads are available from GEO: GSE277112 if you need to reanalyse PacBio data with minimap2.  
   - This notebook processes PacBio HiFi reads, aligns CCS reads, generates processed CCS files, and maps barcodes to variants.  

2. **Enrich2 Analysis**  
   - Use the provided configuration files (in the `Enrich2_counts` folder) to run Enrich2.  
   - Illumina FastQ files required for Enrich2 are available from GEO: GSE277112.  
   - Before running Enrich2, raw sequencing files need to be trimmed by Trimmomatic to crop and keep exactly 30 nucleotide barcodes.  
   - This step counts barcode frequencies in each sorted bin (based on Illumina sequencing of gDNA extracted from cells).  

3. **Variant Scoring**  
   - Run `flowSeq_analysis.ipynb` to process Enrich2 count files and compute barcode/variant scores.  
   - This notebook uses the barcode–variant table generated by `pbData_analysis.ipynb`.  
   - For synonymous variant analysis, run `flowSeq_analysis_Synonymous.ipynb`.  

4. **Pathogenicity Prediction and Comparison with VEP**  
   - Run `Predictions.ipynb` to analyse INSR clinical datasets and evaluate MAVE pathogenicity prediction performance.  

---

**Note:**  
If you only need to analyse variant scores or predictions, you can skip the `Preprocessing PacBio data` and `Enrich2 Analysis` steps — all required input files for `flowSeq_analysis.ipynb`, `flowSeq_analysis_Synonymous.ipynb`, and `Predictions.ipynb` are included in the Zenodo dataset.  
